<app-top-bar [logred]="color" [data]="logocolor" [active]="coler" [btncolor]="btnColor"
    [activeroute]="activeroutes"></app-top-bar>
<hr>
<div class="loading" *ngIf="loading ; else showList">
    <mat-spinner [diameter]="50"></mat-spinner>
</div>
<ng-template #showList>
    <div class="container p-4">
        <div class="row gx-2 border-bottom " *ngIf="listingpupose">
            <div class="col">
                <mat-form-field appearance="outline" *ngIf="listingpupose[0]">
                    <mat-label>Purpose</mat-label>
                    <mat-select [value]="listid" (selectionChange)="onChangeListPurpose($event)">
                        <mat-option *ngFor="let doc of listingpupose" [value]="doc.listingPurposeType"
                            (click)="onclicks(doc.listingPurposeType)">
                            {{doc.desc}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col">
                <mat-form-field appearance="outline" *ngIf="governorate">
                    <mat-label>Governorate</mat-label>
                    <mat-select [value]="governorateid ||all" (selectionChange)="onChangeGovernorate($event)">
                        <mat-option [value]="all" (click)="governorateId()">
                            All
                        </mat-option>
                        <mat-option *ngFor="let doc of governorate" [value]="doc.id" (click)="getGovernorate(doc.id!)">
                            {{doc.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col">
                <mat-form-field appearance="outline" (click)="open(content)">
                    <mat-label>Property category</mat-label>
              
                    <input matInput placeholder="Placeholder" value="{{getpropertyMasterType(mastertypeid)}}">

                </mat-form-field>
                <ng-template #content let-modal >
                    <div class="modal-header pe-4 ps-4">
                        <mat-tab-group (selectedTabChange)="tabChanged($event)">
                            <mat-tab label="Residential">
                                <ng-template matTabContent>
                                    <div class="loading" *ngIf="loading ; else showList">
                                        <mat-spinner [diameter]="50"></mat-spinner>
                                    </div>
                                    <ng-template #showList>
                                        <div class="container pt-4">
                                            <div class="row gx-4" *ngIf="propertysubType">
                                                <div class="col-6 pt-2 ps-3 borderr" *ngFor="let doc of filterFunction(mastertypeid)">
                                                    <div >
                                                        <span value="doc.propertyMasterTypeID" class="text-center"
                                                            value="doc.propertySubType.subType">
                                                            {{doc.propertySubType.desc}}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </ng-template>

                            </mat-tab>
                            <mat-tab label="Commercial">
                                <ng-template matTabContent>
                                    <div class="loading" *ngIf="loading ; else showList">
                                        <mat-spinner [diameter]="50"></mat-spinner>
                                    </div>
                                    <ng-template #showList>
                                        <div class="container">
                                            <div class="row justify-content-md-center btn-row" *ngIf="propertysubType">
                                                <div class="col-6 borderr" *ngFor="let doc of filterFunction(mastertypeid)">
                                                    <div >
                                                        <span value="doc.propertyMasterTypeID"
                                                            value="doc.propertySubType.subType">
                                                            {{doc.propertySubType.desc}}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </ng-template>
                            </mat-tab>
                            <mat-tab label="Residential/Commercial">
                                <ng-template matTabContent>
                                    <div class="loading" *ngIf="loading ; else showList">
                                        <mat-spinner [diameter]="50"></mat-spinner>
                                    </div>
                                    <ng-template #showList>
                                        <div class="container">
                                            <div class="row justify-content-md-center btn-row" *ngIf="propertysubType">
                                                <div class="col-6 borderr" *ngFor="let doc of filterFunction(mastertypeid)">
                                                    <div>
                                                        <span value="doc.propertyMasterTypeID"
                                                            value="doc.propertySubType.subType">
                                                            {{doc.propertySubType.desc}}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </ng-template>
                            </mat-tab>
                        </mat-tab-group>
                    </div>
                </ng-template>
            </div>
            <div class="col">
                <mat-form-field appearance="outline" *ngIf="propertyUnitCategoryType[0]">
                    <mat-label>Unit category</mat-label>
                    <mat-select>
                        <mat-option>All</mat-option>
                        <mat-option *ngFor="let doc of getPropertyUnitCategory(mastertypeid)" [value]="doc.unitCategory" (click)="onUnitcategory(doc.unitCategory)"> 
                            {{doc.desc}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col">
                <div class="row">
                    <div class="col-12">
                        <mat-form-field appearance="outline" (click)="openprice(price)">
                            <mat-label>Price (OMR)</mat-label>
                            <mat-select>
                            </mat-select>
                        </mat-form-field>
                        <ng-template #price let-modal>
                            <div class="modal-header pb-0">
                                <div class="row gx-4">
                                    <div class="container">
                                        <h6 class="primary">Price Range</h6>
                                        <ngx-slider [(value)]="minValue" [(highValue)]="maxValue" [options]="options"></ngx-slider>
                                    </div>
                                   
                                    <div class="col">
                                        <p class="textalign">Min:</p>
                                        <mat-form-field appearance="outline" class="">
                                            <input matInput placeholder="0" [value]="minValue">
                                          
                                        </mat-form-field>
                                    </div>
                                    <div class="col">
                                        <p class="textalign">Max:</p>
                                        <mat-form-field appearance="outline">
                                            <input matInput placeholder="any" [value]="maxValue" >
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="modal-body pt-0">
                                <div class="row gx-2">
                                    <div class="col copywrite">
                                        <mat-list role="list">
                                            <mat-list-item role="listitem" class="item-content"
                                                *ngFor="let value of priceMax"><span class="contact-names btn"
                                                    (click)="addminprice(value)">{{value}}</span></mat-list-item>
                                        </mat-list>
                                    </div>
                                    <div class="col">
                                        <mat-list role="list">
                                            <mat-list-item role="listitem" class="item-content"
                                                *ngFor="let value of priceMin"><span class="contact-names btn"
                                                    (click)="addmaxprice(value)">{{value}}</span></mat-list-item>
                                        </mat-list>

                                    </div>
                                </div>
                            </div> -->
                            <div class="modal-footer">
                                <div class="row  text-center ">
                                    <button mat-flat-button class=" col-6 border" (click)=reSet()>Reset</button>
                                    <button mat-flat-button color="primary" class="col-6 "
                                        (click)=onpopupclose()>Done</button>
                                </div>

                            </div>
                        </ng-template>
                    </div>
                </div>
            </div>
        </div>
        <h4 class="mt-4">Properties for {{getlistpurpose(listid)}} in Oman</h4>

        <app-shortdisplay [listid]="listid" [governorateid]="governorateid" [subTypeId]="subTypeId" [mastertypeid]=" mastertypeid" [minValue]="minValue" [maxValue]="maxValue"
            [unitcategoryid]="unitcategoryid"></app-shortdisplay>
    </div>
</ng-template>