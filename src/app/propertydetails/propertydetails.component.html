<app-top-bar [logred]="color" [data]="logocolor" [active]="coler" [btncolor]="btnColor"
    [activeroute]="activeroutes"></app-top-bar>
<hr>
<div class="loading" *ngIf="loading ; else showList">
    <mat-spinner [diameter]="50"></mat-spinner>
</div>
<ng-template #showList>
    <div class="container p-4">
        <div class="row gx-2 border-bottom " *ngIf="listingpupose">
            <div class="col">
                <mat-form-field appearance="outline" *ngIf="listingpupose[0]">
                    <mat-label>Purpose</mat-label>
                    <mat-select [value]="listid" (selectionChange)="onChangeListPurpose($event)">
                        <mat-option *ngFor="let doc of listingpupose" [value]="doc.listingPurposeType"
                            (click)="onclicks(doc.listingPurposeType)">
                            {{doc.desc}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col">
                <mat-form-field appearance="outline" *ngIf="governorate">
                    <mat-label>Governorate</mat-label>
                    <mat-select [value]="governorateid ||all" (selectionChange)="onChangeGovernorate($event)">
                        <mat-option [value]="all" (click)="governorateId()">
                            All
                        </mat-option>
                        <mat-option *ngFor="let doc of governorate" [value]="doc.id" (click)="getGovernorate(doc.id!)">
                            {{doc.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col">
                <mat-form-field appearance="outline" (click)="open(content)">
                    <mat-label>Property category</mat-label>
                    <input matInput placeholder="Placeholder" value="{{getpropertyMasterType(mastertypeid)}}">
                </mat-form-field>
                <ng-template #content let-modal>
                    <div class="modal-header pe-4 ps-4">
                        <mat-tab-group (selectedTabChange)="tabChanged($event)">
                            <mat-tab label="Residential">
                                <ng-template matTabContent>
                                    <div class="mat-loading" *ngIf="loading ; else showList">
                                        <mat-spinner [diameter]="50"></mat-spinner>
                                    </div>
                                    <ng-template #showList>
                                        <div class="container mt-2">
                                            <div class="row gx-4">
                                                <div class="col-6  pt-2 "
                                                    *ngFor="let doc of filterFunction(mastertypeid)">
                                                    <button type="button" class="tab-btn"
                                                        [value]="doc.propertySubType.subType"
                                                        (click)="onsubtypeid(doc.propertySubType.subType)">{{doc.propertySubType.desc}}</button>

                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </ng-template>

                            </mat-tab>
                            <mat-tab label="Commercial">
                                <ng-template matTabContent>
                                    <div class="mat-loading" *ngIf="loading ; else showList">
                                        <mat-spinner [diameter]="50"></mat-spinner>
                                    </div>
                                    <ng-template #showList>
                                        <div class="container mt-2">
                                            <div class="row gx-4">
                                                <div class="col-6  pt-2 "
                                                    *ngFor="let doc of filterFunction(mastertypeid)">
                                                    <button type="button" class="tab-btn"
                                                        [value]="doc.propertySubType.subType"
                                                        (click)="onsubtypeid(doc.propertySubType.subType)">{{doc.propertySubType.desc}}</button>

                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </ng-template>
                            </mat-tab>
                            <mat-tab label="Residential/Commercial">
                                <ng-template matTabContent>
                                    <div class="mat-loading" *ngIf="loading ; else showList">
                                        <mat-spinner [diameter]="50"></mat-spinner>
                                    </div>
                                    <ng-template #showList>
                                        <div class="container mt-2">
                                            <div class="row gx-4">
                                                <div class="col-6  pt-2 "
                                                    *ngFor="let doc of filterFunction(mastertypeid)">
                                                    <button type="button" class="tab-btn"
                                                        [value]="doc.propertySubType.subType"
                                                        (click)="onsubtypeid(doc.propertySubType.subType)">{{doc.propertySubType.desc}}</button>

                                                </div>
                                            </div>
                                        </div>
                                    </ng-template>
                                </ng-template>
                            </mat-tab>
                        </mat-tab-group>
                    </div>
                </ng-template>
            </div>
            <div class="col">
                <mat-form-field appearance="outline" *ngIf="propertyUnitCategoryType[0]">
                    <mat-label>Unit category</mat-label>
                    <mat-select [value]="unitcategoryid || all">
                        <mat-option [value]="all" (click)="allCheck()">All</mat-option>
                        <mat-option *ngFor="let doc of getPropertyUnitCategory(mastertypeid)" [value]="doc.unitCategory"
                            (click)="onUnitcategory(doc.unitCategory)">
                            {{doc.desc}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col">
                <div class="row">
                    <div class="col-12">
                        <mat-form-field appearance="outline" (click)="openprice(price)">
                            <mat-label>Price (OMR)</mat-label>
                            <mat-select>
                            </mat-select>
                        </mat-form-field>
                        <ng-template #price let-modal>
                            <div class="modal-header pb-0">
                                <div class="row gx-2">
                                    <div class="container">
                                        <h6 class="primary">Price Range</h6>
                                        <ngx-slider [(value)]="minValue" [(highValue)]="maxValue"
                                            [options]="options"></ngx-slider>
                                    </div>

                                    <div class="col-6 mt-4">
                                        <p class="textalign mb-0">Min:</p>
                                        <mat-form-field appearance="outline" class="">
                                            <input matInput placeholder="0" [value]="minValue" [(ngModel)]="minValue">

                                        </mat-form-field>
                                    </div>
                                    <div class="col-6 mt-4">
                                        <p class="textalign mb-0">Max:</p>
                                        <mat-form-field appearance="outline">
                                            <input matInput placeholder="any" [value]="maxValue" [(ngModel)]="maxValue">
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <div class="row gx-2">
                                    <div class="col">
                                        <button type="reset" class="  border-btn" (click)=reSet()>Reset</button>
                                    </div>
                                    <div class="col">
                                        <button type="button" color="primary" class="border-done"
                                            (click)=onpopupclose()>Done</button>
                                    </div>

                                </div>
                            </div>
                        </ng-template>
                    </div>
                </div>
            </div>
        </div>
        <h4 class="mt-4">Properties for {{getlistpurpose(listid)}} in Oman</h4>

        <app-shortdisplay [listid]="listid" [governorateid]="governorateid" [subTypeId]="subTypeId"
            [mastertypeid]=" mastertypeid" [minValue]="minValue" [maxValue]="maxValue"
            [unitcategoryid]="unitcategoryid"></app-shortdisplay>
    </div>
</ng-template>